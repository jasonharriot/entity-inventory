<!DOCTYPE html>

<html>
	<head>
		<link rel="stylesheet" href="style/style.css" />
		<link rel="stylesheet" href="style/fields.css" />
	</head>
	<body>
		<div id="container">
			<div id="header">
				<h1>Entity Inventory</h1>

				<h2><a class="backArrow" href="."><img src="img/arrow_left.png">Home</a></h2>
			</div>

			<div id="contentContainer">
				<div class="section">
					<h2>Entity card for tag no. <span class="fill" id="fillTagID"><i>loading...</i></span></h2>
					<p><input type="button" id="buttonEdit" value="Edit..."/></p>
					<table class="cardTable">
						<tbody>
							<tr class="rowEven">
								<td class="fieldCol">Entity type</td>
								<td class="valueCol fill" id="fillType"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Contents</td>
								<td class="valueCol fill" id="fillContents"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Date</td>
								<td class="valueCol fill" id="fillDateSample"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Initial mass of sample</td>
								<td class="valueCol fill" id="fillMassInitial"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Parent ID(s)</td>
								<td class="valueCol fill" id="fillParentIDs"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Status</td>
								<td class="valueCol fill" id="fillStatus"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Container size</td>
								<td class="valueCol fill" id="fillContainerSize"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Physical form</td>
								<td class="valueCol fill" id="fillForm"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Date of original experiment/batch</td>
								<td class="valueCol fill" id="fillDateExperiment"></td>
							</tr>
						</tbody>
					</table>
					<h3>Notes</h3>
					<div class="cardNotes">
						<div class="fill" id="fillNotes">
							<i>loading...</i>
						</div>
					</div>
					<h3>History</h3>
					<p>The following dates are in UTC for now (TODO!).</p>
					<table class="cardTable">
						<tbody>
							<tr class="rowEven">
								<td class="fieldCol">Date label printed</td>
								<td class="valueCol fill" id="fillDateIssued"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Date first scanned</td>
								<td class="valueCol fill" id="fillDateScannedFirst"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Date first edited</td>
								<td class="valueCol fill" id="fillDateModifiedFirst"></td>
							</tr>
							<tr class="rowOdd">
								<td class="fieldCol">Date last scanned</td>
								<td class="valueCol fill" id="fillDateScannedLatest"></td>
							</tr>
							<tr class="rowEven">
								<td class="fieldCol">Date last edited</td>
								<td class="valueCol fill" id="fillDateModifiedLatest"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<div id="footer">
				EDAC Labs, Inc.
			</div>
		</div>
		<script type="text/javascript" src="js/getCard.js"></script>
		<script type="text/javascript" src="js/showCard.js"></script>
		<script type="text/javascript" src="js/viewCard.js"></script>
		<script type="text/javascript" src="js/getTagID.js"></script>

		<script type="text/javascript">
			const buttonEditElem = document.getElementById('buttonEdit');

			const tagID = getTagID();

			getCard(tagID).then((card) => {
				if(card == null){
					alert('This card does not exist. The tag ID is invalid, or has not been issued yet.');
					history.back();
					return;
				}

				showCard(card)

				buttonEditElem.addEventListener('click', () =>  {
					const hrefString = `editcard.html?tagid=${tagID}`;
					window.location.href = hrefString;
				})

			}).catch( (e) => {
				console.error('Something went wrong:', e);
			});
		</script>
	</body>
</html>
